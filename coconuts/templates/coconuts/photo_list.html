{% extends "coconuts/base.html" %}
{% load coconuts_tags %}
{% load i18n %}
{% load url from future %}

{% block subtitle %}{{ folder }}{% endblock %}

{% block breadcrumbs %}{% coconuts_crumbs folder.path %}{% endblock %}

{% block rssfeeds %}
<link rel="alternate" href="{% url 'coconuts.views.rss' folder.path %}" type="application/rss+xml" title="" id="gallery" />
{% endblock %}

{% block content %}
<h1>{{ folder }}</h1>

{% if can_write %}
<div class="btn-group object-tools">
<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
{% trans "Operations" %}
<span class="caret"></span>
</a>
<ul class="dropdown-menu">
{% if can_write %}
    <li><a class="popup" href="{% url 'coconuts.views.add_file' folder.path %}"><i class="icon-picture"></i> {% trans "Add a file" %}</a></li>
    <li><a class="popup" href="{% url 'coconuts.views.add_folder' folder.path %}"><i class="icon-folder-close"></i> {% trans "Create a folder" %}</a></li>
{% endif %}
{% if can_manage %}
    <li><a class="popup" href="{{ folder.share.manage_url }}"><i class="icon-key"></i> {% trans "Manage this share's permissions" %}</a></li>
{% endif %}
{% if user.is_staff %}
    <li><a href="/admin/auth/user/"><i class="icon-user"></i> {% trans "Manage user accounts" %}</a></li>
{% endif %}
</ul>
</div>
{% endif %}

{% for message in messages %}
<div class="message">{{ message|escape }}</div>
{% endfor %}

{% if not children and not files %}
<p>{% trans "There are no files in this folder." %}</p>
{% else %}

{% verbatim %}
<div ng-app="coconuts" ng-controller="FolderCtrl">
<div class="file" title="{{ folder.filedate }}" ng-repeat="folder in contents.folders">
    <div class="filename"><a href="{{ folder.url }}"><img src="{{ settings.static_root }}img/folder.png"/>{{ folder.name }}</a></div>
    <div class="filesize"></div>
    <div class="fileactions" ng-show="contents.can_write">
        <a class="popup" href="{{ settings.coconuts_root }}images/delete/{{ folder.path }}?back={{ current.url|urlencode }}&amp;next={{ current.url|urlencode }}"><i class="icon-remove"></i> <span co-translate>Delete</span></a>
    </div>
</div>

<div class ng-switch="contents.files.length == contents.photos.length">
    <div ng-switch-when="false">
        <div class="file" title="{{ file.filedate }}" ng-repeat="file in contents.files">
            <div class="filename"><a href="{{ file.url }}"><img src="{{ file.name | fileIcon }}"/>{{ file.name }}</a></div>
            <div class="filesize">{{ file.filesize | fileSize }}</div>
            <div class="fileactions" ng-show="contents.can_write">
                <a class="popup" href="{{ settings.coconuts_root }}images/delete/{{ file.path }}?back={{ current.url|urlencode }}&amp;next={{ current.url|urlencode }}"><i class="icon-remove"></i> <span co-translate>Delete</span></a>
            </div>
        </div>
    </div>
    <div ng-switch-when="true">
        <ul class="thumbnails">
            <li ng-repeat="photo in contents.photos">
                <a class="thumbnail" href="{{ photo.url }}"><img src="{{ settings.coconuts_root }}images/render/{{ photo.path }}?size=128" alt="{{ photo.name }}"/></a>
            </li>
        </ul>
    </div>
</div>
</div>
{% endverbatim %}

{% endif %}
{% endblock %}
